# Cross-term Diagnostics

## Setup

- CWD: /Users/leonkiafaro/Documents/Masterthesis
- R: R version 4.4.2 (2024-10-31)
- Session:

R version 4.4.2 (2024-10-31)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.6

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] C/UTF-8/C/C/C/C

time zone: Europe/Zurich
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] compiler_4.4.2
- GIT HEAD: 375919114ccec9a5cd5955d258699d8b2dd784e0

[WIRE] sourced=/Users/leonkiafaro/Documents/Masterthesis/models/ttm/fit_ttm_crossterm.R
## Run main()

[WARN] main() errored: Error in main() : konnte Funktion "main" nicht finden

## Hyperparameters

- deg_g=2, df_t=6, Q=16, lambda=0.001, H=8

## Training models

[CTM][k=1] n_clipped_pos=0 n_clipped_neg=0 max|h|=6.72874 max|h_raw|=6.72874 max exp(h~)=10.0979
[CTM][k=2] n_clipped_pos=0 n_clipped_neg=2 max|h|=8 max|h_raw|=8.45069 max exp(h~)=2579.19
[CTM][k=3] n_clipped_pos=0 n_clipped_neg=0 max|h|=7.02796 max|h_raw|=7.02796 max exp(h~)=1127.73
[CTM][k=4] n_clipped_pos=0 n_clipped_neg=14 max|h|=8 max|h_raw|=33.0768 max exp(h~)=917.483
[WARN] Monotonicity-of-integral violated in 14 cases
[TAIL][k=1] no samples with |u|>=4 in test set
[TAIL][k=2] no samples with |u|>=4 in test set
[TAIL][k=3] no samples with |u|>=4 in test set
[TAIL][k=4] no samples with |u|>=4 in test set
## Results

- sign_ok rate: 1.0000 (PASS)
- max |h| (clipped): 8 (PASS)
- min J (separable): 0.12906; min J (crossterm): 0.0114912 (PASS)
- sum check train/test (both models): PASS
- NLL crossterm finite (train/test): PASS

### NLL per-dim (train)

      model split k   mean_nll         se
1 separable train 1  2.7936967 0.16185394
2 separable train 2 -0.1432871 0.08636700
3 separable train 3  1.1022424 0.09026187
4 separable train 4  1.5935630 0.13681456
5 crossterm train 1  2.3639758 0.18916529
6 crossterm train 2 -0.2651096 0.21723435
7 crossterm train 3  1.0162020 0.20143747
8 crossterm train 4  1.4567751 0.19824198

### NLL per-dim (test)

      model split k   mean_nll         se
1 separable  test 1  3.0438090  0.5039988
2 separable  test 2  0.1396146  0.2483528
3 separable  test 3  1.1061863  0.2891508
4 separable  test 4  2.8005550  0.9364177
5 crossterm  test 1  2.6145530  0.5272366
6 crossterm  test 2 15.5404417 15.3987397
7 crossterm  test 3  6.2120048  5.0129854
8 crossterm  test 4 22.7422483 20.9525445

### Shapiro p-values (Z, test)

      model k      p_value
1 separable 1 1.601056e-02
2 separable 2 6.534259e-01
3 separable 3 7.943890e-03
4 separable 4 4.090859e-01
5 crossterm 1 5.129014e-01
6 crossterm 2 1.019827e-05
7 crossterm 3 4.867632e-05
8 crossterm 4 4.099879e-06

### Cor(Z) (crossterm, test)

           [,1]       [,2]       [,3]       [,4]
[1,]  1.0000000 -0.5663494  0.6452696 -0.6697017
[2,] -0.5663494  1.0000000 -0.9376851  0.9685604
[3,]  0.6452696 -0.9376851  1.0000000 -0.9556414
[4,] -0.6697017  0.9685604 -0.9556414  1.0000000
