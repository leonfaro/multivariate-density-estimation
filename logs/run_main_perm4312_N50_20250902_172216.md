2025-09-02 17:22:16 [SETUP] CWD=/Users/leonkiafaro/Documents/Masterthesis
2025-09-02 17:22:16 [SETUP] R=R version 4.4.2 (2024-10-31)
2025-09-02 17:22:16 [SETUP] Session:
R version 4.4.2 (2024-10-31)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.6

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] C/UTF-8/C/C/C/C

time zone: Europe/Zurich
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] compiler_4.4.2
2025-09-02 17:22:16 [GIT] HEAD=375919114ccec9a5cd5955d258699d8b2dd784e0
[WIRE] sourced=/Users/leonkiafaro/Documents/Masterthesis/models/ttm/fit_ttm_crossterm.R
2025-09-02 17:22:16 [WIRE] fit_hash(crossterm)=feb950931079652d77b382ad5cde1742, fit_hash(separable)=a8f66a74e4b519b629e736ac1e448ac1
[WIRE] fn_hash(crossterm)=feb950931079652d77b382ad5cde1742 fn_hash(separable)=a8f66a74e4b519b629e736ac1e448ac1
2025-09-02 17:22:16 [ARGS] Enforced N=50, perm=4,3,1,2
2025-09-02 17:22:16 [RUN] Calling main() from main.R ...
[WARN] Skipping True (Joint) for this permutation: log-density not finite
[CTM][k=1] n_clipped_pos=0 n_clipped_neg=0 max|h|=1.79103 max|h_raw|=1.79103 max exp(h~)=5.99561
[CTM][k=2] n_clipped_pos=0 n_clipped_neg=9 max|h|=8 max|h_raw|=25.3566 max exp(h~)=1745.88
[CTM][k=3] n_clipped_pos=16 n_clipped_neg=0 max|h|=8 max|h_raw|=18.362 max exp(h~)=2980.96
[CTM][k=4] n_clipped_pos=0 n_clipped_neg=0 max|h|=6.5752 max|h_raw|=6.5752 max exp(h~)=717.089
[WARN] Monotonicity-of-integral violated in 14 cases
[TAIL][k=1] no samples with |u|>=4 in test set
[TAIL][k=2] no samples with |u|>=4 in test set
[TAIL][k=3] no samples with |u|>=4 in test set
[TAIL][k=4] no samples with |u|>=4 in test set
Ergebnis (NLL in nats; lower is better) [train/test only]
n=50
  dim distribution True (marginal) True (Joint) Random Forest Marginal Map
1   1        gamma     2.21 ± 1.11  2.07 ± 0.80   2.23 ± 1.08  3.00 ± 1.46
2   2         beta    -0.46 ± 0.63 -0.63 ± 1.00  -0.17 ± 0.35  0.39 ± 0.23
3   3         norm     1.46 ± 0.26  1.41 ± 0.29   1.48 ± 0.23  1.46 ± 0.25
4   4          exp     1.55 ± 0.46  1.38 ± 0.65   2.53 ± 0.74  2.58 ± 0.03
5   k          SUM     4.75 ± 1.10  4.23 ± 1.03   6.07 ± 1.58  7.43 ± 1.66
  Separable Map       Cross-term Map Kernel Smooth
1   2.56 ± 1.11          2.16 ± 1.06   2.79 ± 1.87
2   0.31 ± 0.37  17191.38 ± 34380.20   0.08 ± 0.16
3   1.43 ± 0.54 67264.29 ± 134521.65   1.49 ± 0.23
4   2.20 ± 1.62        12.25 ± 14.25   2.29 ± 0.86
5   6.50 ± 1.98 84470.08 ± 168910.57   6.66 ± 2.33
Permutation order 4,3,1,2 (train/test only)
            model train_sec test_sec total_sec
1 True (marginal)     0.052    0.019     0.071
2    True (Joint)     0.000    0.052     0.052
3   Random Forest     2.261    0.215     2.476
4   Kernel Smooth     0.006    0.005     0.011
5    Marginal Map     0.003    0.000     0.003
6   Separable Map     0.009    0.000     0.009
7  Cross-term Map     1.206    0.011     1.217
2025-09-02 17:22:22 [DATA_GEN] Families per dim: norm, exp, beta, gamma
        mean        sd           min       max       skew       kurt
X1 0.1167639 1.1477511 -2.9535798010  2.286645 -0.2614843 -0.3917125
X2 1.9725523 4.5644936  0.0285869887 32.446762  5.9462896 36.7519038
X3 0.6085856 0.3450112  0.0023912213  1.000000 -0.4129085 -1.4666825
X4 2.2128897 2.8771315  0.0003750766 13.664059  2.3497082  5.3814853
2025-09-02 17:22:22 [SPLIT] n_tr=40, n_te=10, seed=42, hash_tr=ff9a3c45f00f66db5739d41dc2654a82, hash_te=89e7922016173627ca87c1178dd9b549
2025-09-02 17:22:22 [STANDARDIZE] mu=1.98234, 0.582363, 0.166856, 2.03839
2025-09-02 17:22:22 [STANDARDIZE] sigma=2.5722, 0.343571, 1.17924, 5.06325
2025-09-02 17:22:22 [STANDARDIZE] sum(-log sigma)=-1.663280, min_sigma=0.343571, any_zero=FALSE
2025-09-02 17:22:22 [TTM_SETUP] enabled_models=TRUE,TRTF,TTM-marginal,TTM-separable,TTM-cross
2025-09-02 17:22:22 [TTM_SETUP] cross-term hyperparams: deg_g=2, df_t=6, Q=16, lambda=1e-3, maxit=50, clip_H=20
2025-09-02 17:22:22 [FIT] TRUE (marginal)
2025-09-02 17:22:22 [FIT] TRUE (joint)
2025-09-02 17:22:22 [WARN] TRUE (joint) failed: log-density not finite
2025-09-02 17:22:22 [FIT] TRTF (random forest)
2025-09-02 17:22:25 [FIT] TTM Marginal
2025-09-02 17:22:25 [FIT] TTM Separable
2025-09-02 17:22:25 [FIT] TTM Cross-term
[CTM][k=1] n_clipped_pos=0 n_clipped_neg=0 max|h|=1.79103 max|h_raw|=1.79103 max exp(h~)=5.99561
[CTM][k=2] n_clipped_pos=0 n_clipped_neg=9 max|h|=8 max|h_raw|=25.3566 max exp(h~)=1745.88
